<mat-sidenav-container class="h-full">
  <mat-sidenav [opened]="showInfoPanel$()" mode="side" position="end">
    <div class="demo-placeholder">
      Message Room Info Panel
    </div>
  </mat-sidenav>
  <mat-sidenav-content style="overflow: visible;">
    <mat-progress-spinner *ngIf="loadingRoom$(); else $roomLoaded"
                          mode="indeterminate" diameter="24"
                          class="mx-auto my-4">
    </mat-progress-spinner>

    <ng-template #$roomLoaded>
      <div class="h-full flex flex-col justify-end" *ngIf="room$(); else $noRoom">
        <div class="messages-container">
          <div *ngFor="let message of messages.list$(); trackBy: trackBy.message"
               class="message"
               [class.self]="message.self">
            <p>{{message.data.text}}</p>
            <p class="time">{{message.data.createdAt}}</p>
          </div>
        </div>
        <mat-divider></mat-divider>
        <div class="bg-white p-2">
          <form class="flex gap-2" (ngSubmit)="sendTextMessage()">
            <div id="text-message-field" class="form-field mb-0 flex-grow self-center">
              <div class="field field-interactive">
                <textarea [formControl]="messages.text.form"
                          cdkTextareaAutosize
                          class="resize-none"
                          style="max-height: min(10rem, 30vh);"></textarea>
              </div>
            </div>
            <button type="submit" mat-ripple
                    [disabled]="!messages.text.canSend$()"
                    class="icon-button self-end 
                    text-primary/70 disabled:text-slate-300
                    enabled:hover:text-primary 
                    enabled:focus:text-primary">
              <fa-icon [icon]="icons.faPlay" class="ml-[0.3rem]"></fa-icon>
            </button>
          </form>
        </div>
      </div>

      <ng-template #$noRoom>
        <div class="h-full grid place-content-center p-4">
          <fa-icon [icon]="icons.faComments"
                   class="mx-auto text-6xl text-slate-300"></fa-icon>
          <p class="mt-4 text-slate-400">Please select a conversation to view messages</p>
        </div>
      </ng-template>
    </ng-template>

  </mat-sidenav-content>
</mat-sidenav-container>