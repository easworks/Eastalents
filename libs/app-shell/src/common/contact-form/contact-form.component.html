<form *ngrxLet="contact.form as form" [formGroup]="form"
      (ngSubmit)="contact.submit()">
  <div *ngrxLet="form.controls.name as control"
       [formFieldControl]="control">
    <label>Name <span class="text-warn">*</span></label>
    <input type="text" [formControl]="control">
  </div>

  <div *ngrxLet="form.controls.email as control"
       [formFieldControl]="control">
    <label>Email <span class="text-warn">*</span></label>
    <input type="text" [formControl]="control">
  </div>

  <div *ngrxLet="form.controls.phoneNumber as form"
       [formFieldControl]="form">

    <label>Phone Number</label>

    <div class="flex gap-2 justify-start">
      <div *ngrxLet="form.controls.code as control" class="relative">
        <input type="tel" class="!w-24 !pr-4"
               [matAutocomplete]="codeOptions"
               [formControl]="control" placeholder="ISD Code">
        <drop-down-indicator class="absolute top-1 right-0"></drop-down-indicator>

        <mat-autocomplete #codeOptions panelWidth="auto" hideSingleSelectionIndicator>
          <mat-option *ngFor="let country of contact.options.code$(); trackBy: trackBy.country"
                      [value]="country.phonecode" (onSelectionChange)="$event.source.deselect();">
            <div class="flex gap-4 items-center">
              <span class="font-emoji">{{country.emoji}}</span>
              <span>{{country.phonecode}}</span>
            </div>
          </mat-option>
        </mat-autocomplete>
      </div>

      <input type="tel"
             *ngrxLet="form.controls.number as control"
             [formControl]="control" placeholder="Number">
    </div>
    <span class="error" *ngIf="form.controls.code.invalid">Invalid Code</span>
    <span class="error" *ngIf="form.controls.number.hasError('pattern')">Invalid number</span>
    <span class="error" *ngIf="form.controls.number.hasError('required')">Number required</span>
  </div>

  <div *ngrxLet="form.controls.subject as control"
       [formFieldControl]="control">
    <label>Subject <span class="text-warn">*</span></label>
    <input type="text" [formControl]="control">
  </div>

  <div *ngrxLet="form.controls.message as control"
       [formFieldControl]="control">
    <label>Message</label>
    <div class="field field-interactive">
      <textarea [formControl]="control" class="resize-none" rows="5"></textarea>
    </div>
  </div>

  <button type="submit"
          class="shaded-button primary"
          mat-ripple
          [disabled]="loading.any$()">
    <replace-spinner [showSpinner]="contact.submitting$()">
      Send message
    </replace-spinner>
  </button>
</form>